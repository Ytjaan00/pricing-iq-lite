<!doctype html>
<html lang="hi">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>Pricing IQ Lite — Invoice + Price Suggest</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
<style>
  :root{
    --bg:#061018; --card:#0f1724; --muted:#9aa4b2; --accent:#6EE7B7; --gold:#ffd166;
    --radius:12px; font-family:Inter,system-ui,Arial;
  }
  *{box-sizing:border-box}
  body{margin:0;background:linear-gradient(180deg,#02060a,var(--bg));color:#e6eef8;min-height:100vh;padding:18px}
  .wrap{max-width:980px;margin:0 auto;display:grid;grid-template-columns:1fr 420px;gap:18px}
  .card{background:linear-gradient(180deg,rgba(255,255,255,0.02),rgba(255,255,255,0.01));border-radius:var(--radius);padding:16px;border:1px solid rgba(255,255,255,0.03)}
  header{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}
  .logo{width:56px;height:56px;border-radius:12px;background:linear-gradient(135deg,var(--accent),var(--gold));display:flex;align-items:center;justify-content:center;font-weight:800;color:#061018}
  h1{margin:0;font-size:18px}
  .muted{color:var(--muted);font-size:13px}
  label{display:block;color:var(--muted);font-size:13px;margin-top:8px;margin-bottom:6px}
  input, select, textarea{width:100%;padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.03);background:rgba(255,255,255,0.02);color:inherit;font-size:14px}
  .row{display:flex;gap:8px}
  .btn{background:linear-gradient(90deg,var(--accent),var(--gold));border:0;padding:10px 12px;border-radius:10px;color:#061018;font-weight:700;cursor:pointer}
  .small{padding:8px 10px;border-radius:8px;background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted);cursor:pointer}
  .result{margin-top:12px;padding:12px;border-radius:10px;background:rgba(255,255,255,0.01);border:1px solid rgba(255,255,255,0.02)}
  .flex{display:flex;justify-content:space-between;align-items:center}
  .tag{background:rgba(255,255,255,0.02);padding:6px 8px;border-radius:8px;font-size:12px;color:var(--muted)}
  .previewCard{width:360px;height:420px;padding:18px;border-radius:12px;background:linear-gradient(180deg,#071018,#0b1220);display:flex;flex-direction:column;justify-content:space-between}
  .pc-title{font-weight:700;font-size:18px;color:var(--accent)}
  .pc-fact{font-size:15px;color:#dfe9f2}
  footer{margin-top:12px;color:var(--muted);font-size:13px;text-align:center}
  @media (max-width:900px){.wrap{grid-template-columns:1fr;}.logo{display:none}}
</style>
</head>
<body>
  <div style="max-width:980px;margin:0 auto">
    <header style="display:flex;justify-content:space-between;align-items:center">
      <div style="display:flex;gap:12px;align-items:center">
        <div class="logo">IQ</div>
        <div>
          <h1>Pricing IQ Lite</h1>
          <div class="muted">Suggested price + Quick invoice • No login • Data saved on your phone</div>
        </div>
      </div>
      <div class="tag">Halal-friendly • Privacy first</div>
    </header>

    <div class="wrap">
      <!-- LEFT: Pricing form + invoice -->
      <div class="card">
        <div><strong>1) Price Suggestion</strong></div>

        <label>Skill / Service (उदा. Web Design, Logo, Writing)</label>
        <input id="skill" placeholder="उदा. Web Design">

        <div class="row" style="margin-top:8px">
          <div style="flex:1">
            <label>Experience (साल)</label>
            <input id="exp" type="number" min="0" value="1">
          </div>
          <div style="flex:1">
            <label>Location (Country)</label>
            <select id="country">
              <option value="IN">India (IN)</option>
              <option value="US">United States (US)</option>
              <option value="AE">UAE (AE)</option>
              <option value="PK">Pakistan (PK)</option>
              <option value="GB">UK (GB)</option>
              <option value="OTHER">Other</option>
            </select>
          </div>
        </div>

        <label>Project Type</label>
        <select id="projType">
          <option value="hourly">Hourly</option>
          <option value="fixed">Fixed Price</option>
        </select>

        <div class="row" style="margin-top:8px">
          <div style="flex:1">
            <label>Estimated Hours (यदि hourly)</label>
            <input id="hours" type="number" min="0" value="10">
          </div>
          <div style="flex:1">
            <label>Complexity</label>
            <select id="complexity">
              <option value="1">Low</option>
              <option value="1.25">Medium</option>
              <option value="1.6">High</option>
            </select>
          </div>
        </div>

        <div style="display:flex;gap:8px;margin-top:12px">
          <button class="btn" id="calcBtn">Get Suggestion</button>
          <button class="small" id="saveBtn">Save Locally</button>
          <button class="small" id="clearBtn">Clear</button>
        </div>

        <div class="result" id="resultBox" style="display:none">
          <div class="flex"><div><strong>Suggestion</strong></div><div class="muted" id="resCurrency">₹</div></div>
          <div style="margin-top:8px">
            <div style="font-size:20px;font-weight:700" id="priceText">—</div>
            <div class="muted" id="priceRange">—</div>
            <div style="margin-top:8px" id="proposalText"></div>
          </div>

          <div style="display:flex;gap:8px;margin-top:10px">
            <button class="btn" id="copyProposal">Copy Proposal</button>
            <button class="small" id="exportCard">Export Card (PNG)</button>
          </div>
        </div>

        <hr style="border:0;border-top:1px solid rgba(255,255,255,0.03);margin:12px 0">

        <div><strong>2) Quick Invoice</strong></div>
        <label>Client Name</label>
        <input id="clientName" placeholder="Client Name">

        <label>Item Description</label>
        <input id="itemDesc" placeholder="Service (e.g., Website Design)">

        <div class="row" style="margin-top:8px">
          <div style="flex:1">
            <label>Amount (numeric)</label>
            <input id="itemAmt" type="number" min="0" value="0">
          </div>
          <div style="flex:1">
            <label>Tax % (optional)</label>
            <input id="tax" type="number" min="0" value="0">
          </div>
        </div>

        <div style="display:flex;gap:8px;margin-top:10px">
          <button class="btn" id="genInvoice">Generate Invoice</button>
          <button class="small" id="saveInvoice">Save Invoice Locally</button>
        </div>

        <div id="invoicePreview" style="display:none;margin-top:12px"></div>

        <footer style="margin-top:12px">
          <div class="muted">Note: कोई सर्वर नहीं — आपका डाटा आपके ब्राउज़र में रहता है</div>
        </footer>
      </div>

      <!-- RIGHT: Preview card + invoice print -->
      <div class="card">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div>
            <div class="muted">Live Pricing Card</div>
            <div style="font-weight:700;font-size:16px" id="cardSkill">No skill</div>
          </div>
          <div class="tag" id="cardTag">Pricing IQ</div>
        </div>

        <div style="margin-top:12px;display:flex;justify-content:center">
          <div class="previewCard" id="previewCard">
            <div>
              <div class="pc-title" id="pcTitle">Suggested Price</div>
              <div style="height:8px"></div>
              <div class="pc-fact" id="pcMain">No suggestion yet. Click Get Suggestion.</div>
            </div>
            <div style="display:flex;justify-content:space-between;align-items:center">
              <div class="muted" id="pcFooter">Halal • Privacy</div>
              <div class="muted" id="pcDate"></div>
            </div>
          </div>
        </div>

        <div style="display:flex;gap:8px;margin-top:12px;justify-content:space-between">
          <button class="small" id="shareQuick">Copy Share Text</button>
          <button class="small" id="printInvoice">Print Last Invoice</button>
        </div>

        <div style="margin-top:10px" class="muted">Tip: Share your card to get organic traffic.</div>
      </div>

    </div> <!-- wrap -->

  </div>

<!-- html2canvas CDN for PNG export -->
<script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>

<script>
  // Simple pricing heuristic data
  const baseByCountry = {
    'IN': 300, // ₹ per hour baseline
    'US': 25,  // $ per hour baseline (we'll convert later)
    'AE': 40,  // AED
    'PK': 200,
    'GB': 20,
    'OTHER': 10
  };

  const currencySymbol = {'IN':'₹','US':'$','AE':'د.إ','PK':'₨','GB':'£','OTHER':'$'};

  function toNumber(v){ return Number(v)||0; }

  // convert US$ to INR approx if needed (simple static rates, offline-friendly)
  const fx = {
    'US_TO_IN': 83, // 1 USD = 83 INR (approx)
    'AE_TO_IN': 23, // 1 AED = 23 INR
    'GB_TO_IN': 102
  };

  function computeSuggestion(){
    const skill = document.getElementById('skill').value.trim() || 'Service';
    const exp = Math.max(0, toNumber(document.getElementById('exp').value));
    const country = document.getElementById('country').value;
    const projType = document.getElementById('projType').value;
    const hours = Math.max(0, toNumber(document.getElementById('hours').value));
    const complexity = parseFloat(document.getElementById('complexity').value) || 1;

    // baseRate local currency per hour
    let base = baseByCountry[country] || baseByCountry['OTHER'];

    // adjust for experience (5% per year)
    const expMultiplier = 1 + (Math.min(exp,10) * 0.05); // cap at 10 years for sanity

    // skill premium: if skill text contains "design" "dev" "logo" "seo" "write"
    const s = skill.toLowerCase();
    let skillPremium = 1;
    if(s.includes('design') || s.includes('dev') || s.includes('developer') || s.includes('engineer')) skillPremium = 1.25;
    if(s.includes('logo') || s.includes('brand')) skillPremium = 1.15;
    if(s.includes('write') || s.includes('content') || s.includes('copy')) skillPremium = 0.9;
    if(s.includes('seo') || s.includes('ads')) skillPremium = 1.05;

    // final hourly
    let hourly = Math.round(base * expMultiplier * skillPremium * complexity);

    // If country is US/GB/A E, show currency symbol accordingly
    const symbol = currencySymbol[country] || '$';

    // For fixed price: estimate range
    let fixedLow = hourly * Math.max(1, hours*0.7);
    let fixedHigh = hourly * Math.max(1, hours*1.3);

    // If project type hourly: show hourly suggestion + estimate total
    let displayText = '';
    if(projType === 'hourly'){
      displayText = `${symbol}${hourly} / hour  — est: ${symbol}${(hourly*hours).toLocaleString()} for ${hours} hrs`;
    } else {
      displayText = `Fixed: ${symbol}${Math.round(fixedLow)} — ${symbol}${Math.round(fixedHigh)} (for ${hours} hrs est)`;
    }

    // prepare proposal line
    const proposal = `Hi, I can deliver ${skill} for ${projType==='hourly'? symbol+hourly+'/hr' : symbol+Math.round((fixedLow+fixedHigh)/2)}. Timeline: ___ days. Let me know to start.`;

    // return object
    return {skill, hourly, symbol, hours, fixedLow, fixedHigh, displayText, proposal};
  }

  // UI hooks
  const calcBtn = document.getElementById('calcBtn');
  const resultBox = document.getElementById('resultBox');
  const priceText = document.getElementById('priceText');
  const priceRange = document.getElementById('priceRange');
  const proposalText = document.getElementById('proposalText');
  const copyProposal = document.getElementById('copyProposal');
  const exportCard = document.getElementById('exportCard');
  const pcMain = document.getElementById('pcMain');
  const pcDate = document.getElementById('pcDate');
  const cardSkill = document.getElementById('cardSkill');
  const saveBtn = document.getElementById('saveBtn');
  const clearBtn = document.getElementById('clearBtn');

  calcBtn.addEventListener('click', ()=>{
    const out = computeSuggestion();
    resultBox.style.display='block';
    priceText.textContent = out.displayText;
    priceRange.textContent = `Estimated range: ${out.symbol}${out.fixedLow.toLocaleString()} — ${out.symbol}${out.fixedHigh.toLocaleString()}`;
    proposalText.innerHTML = `<div style="margin-top:8px;color:var(--muted)">${out.proposal}</div>`;
    pcMain.textContent = out.displayText;
    pcDate.textContent = new Date().toLocaleDateString();
    cardSkill.textContent = out.skill;
    // save last suggestion
    localStorage.setItem('lastSuggestion', JSON.stringify(out));
  });

  copyProposal.addEventListener('click', ()=>{
    const txt = proposalText.innerText || '';
    navigator.clipboard.writeText(txt).then(()=>alert('Proposal copied to clipboard'));
  });

  exportCard.addEventListener('click', async ()=>{
    const node = document.getElementById('previewCard');
    // temporarily enlarge for better resolution
    const scale = 2;
    try{
      const canvas = await html2canvas(node, {scale:scale, backgroundColor:null});
      const link = document.createElement('a');
      link.download = 'pricing-card.png';
      link.href = canvas.toDataURL('image/png');
      link.click();
    }catch(err){ alert('Export failed: '+err); }
  });

  saveBtn.addEventListener('click', ()=>{
    const skill = document.getElementById('skill').value;
    const exp = document.getElementById('exp').value;
    const country = document.getElementById('country').value;
    localStorage.setItem('savedProfile', JSON.stringify({skill,exp,country}));
    alert('Saved locally on this device');
  });

  clearBtn.addEventListener('click', ()=>{
    if(confirm('Clear form and local saved suggestion?')){
      document.getElementById('skill').value='';
      document.getElementById('exp').value=1;
      document.getElementById('hours').value=10;
      resultBox.style.display='none';
      localStorage.removeItem('lastSuggestion');
    }
  });

  // load saved profile if any
  (function loadSaved(){
    const p = localStorage.getItem('savedProfile');
    if(p){
      try{
        const obj = JSON.parse(p);
        document.getElementById('skill').value = obj.skill || '';
        document.getElementById('exp').value = obj.exp || 1;
        document.getElementById('country').value = obj.country || 'IN';
      }catch(e){}
    }
    const last = localStorage.getItem('lastSuggestion');
    if(last){
      try{ const o=JSON.parse(last); document.getElementById('pcMain').textContent = o.displayText; document.getElementById('cardSkill').textContent = o.skill; document.getElementById('pcDate').textContent = new Date().toLocaleDateString(); resultBox.style.display='block'; priceText.textContent = o.displayText;}catch(e){}
    }
  })();

  // Invoice builder
  document.getElementById('genInvoice').addEventListener('click', ()=>{
    const client = document.getElementById('clientName').value || 'Client';
    const desc = document.getElementById('itemDesc').value || 'Service';
    const amt = toNumber(document.getElementById('itemAmt').value);
    const tax = toNumber(document.getElementById('tax').value);
    if(amt<=0){ alert('Enter valid amount'); return; }

    const taxAmt = Math.round((amt * tax)/100);
    const total = amt + taxAmt;
    const invNum = 'IQ-'+Date.now().toString().slice(-6);
    const date = new Date().toLocaleDateString();

    const html = `
      <div style="padding:20px;font-family:Inter,Arial;color:#061018;">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div><h2>Invoice</h2><div>Invoice #: ${invNum}</div></div>
          <div style="text-align:right">
            <div><strong>From:</strong> Pricing IQ Lite</div>
            <div><small>Halal-friendly</small></div>
          </div>
        </div>
        <hr/>
        <div><strong>Bill To:</strong> ${escapeHtml(client)}</div>
        <table style="width:100%;margin-top:10px;border-collapse:collapse">
          <tr style="background:#f6f6f6"><td style="padding:8px;border:1px solid #ddd">Description</td><td style="padding:8px;border:1px solid #ddd">Amount</td></tr>
          <tr><td style="padding:8px;border:1px solid #ddd">${escapeHtml(desc)}</td><td style="padding:8px;border:1px solid #ddd">${amt}</td></tr>
          <tr><td style="padding:8px;border:1px solid #ddd">Tax (${tax}%)</td><td style="padding:8px;border:1px solid #ddd">${taxAmt}</td></tr>
          <tr><td style="padding:8px;border:1px solid #ddd"><strong>Total</strong></td><td style="padding:8px;border:1px solid #ddd"><strong>${total}</strong></td></tr>
        </table>
        <div style="margin-top:12px">Date: ${date}</div>
        <div style="margin-top:12px"><button onclick="window.print()" style="padding:8px 10px;border-radius:8px;background:#6EE7B7;border:0;cursor:pointer">Print / Save as PDF</button></div>
      </div>`;

    const preview = document.getElementById('invoicePreview');
    preview.innerHTML = html;
    preview.style.display = 'block';

    // also open in new window for print
    const newWin = window.open('', '_blank', 'width=800,height=800');
    newWin.document.write('<html><head><title>Invoice</title><meta charset="utf-8"></head><body>' + html + '</body></html>');
    newWin.document.close();
  });

  document.getElementById('saveInvoice').addEventListener('click', ()=>{
    const inv = {
      client: document.getElementById('clientName').value,
      desc: document.getElementById('itemDesc').value,
      amt: document.getElementById('itemAmt').value,
      tax: document.getElementById('tax').value,
      date: new Date().toISOString()
    };
    const arr = JSON.parse(localStorage.getItem('invoices')||'[]');
    arr.unshift(inv);
    localStorage.setItem('invoices', JSON.stringify(arr));
    alert('Invoice saved locally');
  });

  document.getElementById('printInvoice').addEventListener('click', ()=>{
    // try to open last invoice if any
    const arr = JSON.parse(localStorage.getItem('invoices')||'[]');
    if(!arr.length){ alert('No saved invoice. Generate one first.'); return; }
    const inv = arr[0];
    const html = `<div style="padding:20px;font-family:Inter,Arial;color:#061018;">
      <h2>Invoice</h2><div>Client: ${escapeHtml(inv.client)}</div><div>Description: ${escapeHtml(inv.desc)}</div><div>Amount: ${inv.amt}</div></div>`;
    const w = window.open('', '_blank', 'width=800,height=800');
    w.document.write('<html><head><title>Invoice</title></head><body>'+html+'</body></html>');
    w.document.close();
    w.print();
  });

  // helper
  function escapeHtml(s){ return (''+s).replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c])); }
</script>
</body>
</html>
